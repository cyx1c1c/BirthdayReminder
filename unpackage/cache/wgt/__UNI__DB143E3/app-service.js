if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}const a=(e,t)=>{const a=e.__vccOpts||e;for(const[i,n]of t)a[i]=n;return a};const i=a({data:()=>({name:"",birthday:"",remindDays:null,birthdays:[]}),mounted(){this.loadBirthdays()},methods:{onDateChange(e){this.birthday=e.detail.value},calculateDaysLeft(e){let t=new Date,a=new Date(e);a.setFullYear(t.getFullYear()),a<t&&a.setFullYear(t.getFullYear()+1);let i=a-t;return Math.ceil(i/864e5)},sortBirthdays(){this.birthdays.sort(((e,t)=>this.calculateDaysLeft(e.birthday)-this.calculateDaysLeft(t.birthday)))},async addBirthday(){this.name&&this.birthday&&(this.birthdays.push({name:this.name,birthday:this.birthday,remindDays:this.remindDays||0}),await this.sortBirthdays(),await this.saveBirthdays(),uni.showToast({title:"添加成功！",icon:"success"}),this.name="",this.birthday="",this.remindDays=null)},async saveBirthdays(){try{await uni.setStorageSync("birthdays",JSON.stringify(this.birthdays))}catch(e){t("error","at pages/addBirthday.vue:71","存储失败",e)}},loadBirthdays(){const e=uni.getStorageSync("birthdays");this.birthdays=e?JSON.parse(e):[],this.sortBirthdays()}}},[["render",function(t,a,i,n,r,o){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>r.name=e),placeholder:"姓名",required:""},null,512),[[e.vModelText,r.name]]),e.createElementVNode("picker",{mode:"date",value:r.birthday,onChange:a[1]||(a[1]=(...e)=>o.onDateChange&&o.onDateChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(r.birthday||"选择生日"),1)],40,["value"]),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>r.remindDays=e),placeholder:"提前几天提醒"},null,512),[[e.vModelText,r.remindDays,void 0,{number:!0}]]),e.createElementVNode("button",{onClick:a[3]||(a[3]=(...e)=>o.addBirthday&&o.addBirthday(...e))},"添加生日")])}],["__scopeId","data-v-2b74d4c1"]]),n={"伦敦（UTC+0）":0,"巴黎（UTC+1）":1,"柏林（UTC+1）":1,"莫斯科（UTC+3）":3,"新德里（UTC+5:30）":5.5,"北京（UTC+8）":8,"东京（UTC+9）":9,"悉尼（UTC+10）":10,"墨尔本（UTC+11）":11,"洛杉矶（UTC-8）":-8,"纽约（UTC-5）":-5,"圣保罗（UTC-3）":-3},r=Object.keys(n);const o=a({data:()=>({birthdays:[],showEditPopup:!1,editBirthday:{},editIndex:null}),onShow(){this.loadBirthdays()},methods:{loadBirthdays(){const e=uni.getStorageSync("birthdays");this.birthdays=e?JSON.parse(e):[]},deleteBirthday(e){this.birthdays.splice(e,1),this.saveBirthdays(),this.loadBirthdays()},saveBirthdays(){uni.setStorageSync("birthdays",JSON.stringify(this.birthdays))},calculateDaysLeft(e){let t=uni.getStorageSync("selectedTimezone"),a=n[t]||0,i=new Date,r=i.getTime()+6e4*i.getTimezoneOffset(),o=new Date(r+36e5*a),s=new Date(e);s.setFullYear(o.getFullYear());let d=s-o;return d<=0&&o.toDateString()===s.toDateString()?0:(d<0&&(s.setFullYear(o.getFullYear()+1),d=s-o),Math.ceil(d/864e5))},onDateChange(e){this.editBirthday.birthday=e.detail.value},openEditPopup(e,t){this.editBirthday={...e},this.editIndex=t,this.showEditPopup=!0},closeEditPopup(){this.showEditPopup=!1},sortBirthdays(){this.birthdays.sort(((e,t)=>this.calculateDaysLeft(e.birthday)-this.calculateDaysLeft(t.birthday)))},async changeBirthday(){this.editBirthday.name&&this.editBirthday.birthday?(this.birthdays[this.editIndex]={...this.editBirthday},await this.sortBirthdays(),await this.saveBirthdays(),this.closeEditPopup(),uni.showToast({title:"修改成功！",icon:"success"})):uni.showToast({title:"信息不完整！",icon:"none"})},saveChanges(){this.changeBirthday()},viewDetails(e){uni.navigateTo({url:"/pages/detail?name="+e.name+"&birthday="+e.birthday+"&remindDays="+e.remindDays+"&daysLeft="+this.calculateDaysLeft(e.birthday)})}}},[["render",function(t,a,i,n,r,o){return e.openBlock(),e.createElementBlock("view",{class:"container"},[r.birthdays.length?(e.openBlock(),e.createElementBlock("ul",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.birthdays,((t,a)=>(e.openBlock(),e.createElementBlock("li",{key:a},[e.createElementVNode("strong",null,e.toDisplayString(t.name),1),e.createTextVNode(" - "+e.toDisplayString(t.birthday)+" (剩余 "+e.toDisplayString(o.calculateDaysLeft(t.birthday))+" 天) ",1),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{onClick:e=>o.viewDetails(t),id:"detail-button"},"详情",8,["onClick"]),e.createElementVNode("button",{onClick:e=>o.openEditPopup(t,a),id:"change-button"},"修改",8,["onClick"]),e.createElementVNode("button",{onClick:e=>o.deleteBirthday(a),id:"delete-button"},"删除",8,["onClick"])])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1},"暂无生日记录")),r.showEditPopup?(e.openBlock(),e.createElementBlock("view",{key:2,class:"popup-overlay"},[e.createElementVNode("view",{class:"popup"},[e.createElementVNode("h2",null,"修改生日信息"),e.createElementVNode("form",{onSubmit:a[5]||(a[5]=e.withModifiers(((...e)=>o.saveChanges&&o.saveChanges(...e)),["prevent"]))},[e.createElementVNode("view",null,[e.createElementVNode("label",{for:"name"},"姓名:"),e.withDirectives(e.createElementVNode("input",{id:"name","onUpdate:modelValue":a[0]||(a[0]=e=>r.editBirthday.name=e),placeholder:"请输入姓名",required:""},null,512),[[e.vModelText,r.editBirthday.name]])]),e.createElementVNode("view",null,[e.createElementVNode("label",{for:"birthday"},"生日:"),e.createElementVNode("picker",{mode:"date",value:r.editBirthday.birthday,onChange:a[1]||(a[1]=(...e)=>o.onDateChange&&o.onDateChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(r.editBirthday.birthday||"选择生日"),1)],40,["value"])]),e.createElementVNode("view",null,[e.createElementVNode("label",{for:"remindDays"},"提前提醒天数:"),e.withDirectives(e.createElementVNode("input",{id:"remindDays","onUpdate:modelValue":a[2]||(a[2]=e=>r.editBirthday.remindDays=e),type:"number",min:"1",required:""},null,512),[[e.vModelText,r.editBirthday.remindDays]])]),e.createElementVNode("view",{class:"buttons"},[e.createElementVNode("button",{type:"submit",onClick:a[3]||(a[3]=(...e)=>o.changeBirthday&&o.changeBirthday(...e)),id:"save-button"},"保存"),e.createElementVNode("button",{type:"button",onClick:a[4]||(a[4]=(...e)=>o.closeEditPopup&&o.closeEditPopup(...e)),id:"cancel-button"},"取消")])],32)])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-d6be05ee"]]);const s=a({components:{},data:()=>({timezones:r,selectedIndex:null,selectedTimezone:""}),mounted(){const e=uni.getStorageSync("selectedTimezone");e?(this.selectedTimezone=e,this.selectedIndex=this.timezones.indexOf(e)):this.setDeviceTimezone()},methods:{setDeviceTimezone(){const e=(new Date).getTimezoneOffset()/-60,t=Object.keys(n).find((t=>n[t]===e));t&&(this.selectedTimezone=t,this.selectedIndex=this.timezones.indexOf(t),uni.setStorageSync("selectedTimezone",t))},onTimezoneChange(e){this.selectedIndex=e.detail.value,this.selectedTimezone=this.timezones[this.selectedIndex],uni.setStorageSync("selectedTimezone",this.selectedTimezone)}}},[["render",function(t,a,i,n,r,o){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("picker",{mode:"selector",range:r.timezones,value:r.selectedIndex,onChange:a[0]||(a[0]=(...e)=>o.onTimezoneChange&&o.onTimezoneChange(...e))},[e.createElementVNode("view",{class:"picker"},"选择时区: "+e.toDisplayString(r.selectedTimezone||"请选择时区"),1)],40,["range","value"])])}],["__scopeId","data-v-73f7808e"]]);const d=a({data:()=>({name:"",birthday:"",remindDays:null,birthdays:[]}),mounted(){this.loadBirthdays(),this.startReminderCheck()},methods:{onDateChange(e){this.birthday=e.detail.value},addBirthday(){if(t("log","at pages/index/index.vue:41","addBirthday 方法被调用"),!this.name||!this.birthday||this.remindDays<0)return t("log","at pages/index/index.vue:43","输入信息不完整"),void uni.showToast({title:"请填写正确的生日信息",icon:"none"});t("log","at pages/index/index.vue:47","生日信息通过验证");const e={name:this.name,birthday:this.birthday,remindDays:this.remindDays};this.birthdays.push(e),t("log","at pages/index/index.vue:55","新生日已加入数组",this.birthdays),this.saveBirthdays(),this.name="",this.birthday="",this.remindDays=null,t("log","at pages/index/index.vue:61","数据已清空")},saveBirthdays(){uni.setStorage({key:"birthdays",data:this.birthdays,success:()=>t("log","at pages/index/index.vue:67","生日数据已存入本地缓存"),fail:e=>t("error","at pages/index/index.vue:68","存储失败",e)})},loadBirthdays(){const e=uni.getStorageSync("birthdays");this.birthdays=e?JSON.parse(e):[]},deleteBirthday(e){this.birthdays.splice(e,1),this.saveBirthdays()},calculateDaysLeft(e){const t=new Date,a=new Date(e);a.setFullYear(t.getFullYear()),a<t&&a.setFullYear(t.getFullYear()+1);const i=a.getTime()-t.getTime();return Math.ceil(i/864e5)},sendNotification(e,t){uni.showModal({title:"生日提醒",content:`${e} 的生日还有 ${t} 天！`,showCancel:!1})},checkReminders(){this.birthdays.forEach((e=>{const t=this.calculateDaysLeft(e.birthday);t===e.remindDays&&this.sendNotification(e.name,t)}))},startReminderCheck(){setInterval(this.checkReminders,864e5)}}},[["render",function(t,a,i,n,r,o){return e.openBlock(),e.createElementBlock("div",{class:"container"},[e.createElementVNode("h1",null,"生日倒计时"),e.createElementVNode("form",{onSubmit:a[4]||(a[4]=e.withModifiers(((...e)=>o.addBirthday&&o.addBirthday(...e)),["prevent"]))},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>r.name=e),placeholder:"姓名",required:""},null,512),[[e.vModelText,r.name]]),e.createElementVNode("picker",{mode:"date",value:r.birthday,onChange:a[1]||(a[1]=(...e)=>o.onDateChange&&o.onDateChange(...e))},[e.createElementVNode("view",{class:"picker"},e.toDisplayString(r.birthday||"选择生日"),1)],40,["value"]),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>r.remindDays=e),placeholder:"提前几天提醒",required:""},null,512),[[e.vModelText,r.remindDays,void 0,{number:!0}]]),e.createElementVNode("button",{type:"button",onClick:a[3]||(a[3]=(...e)=>o.addBirthday&&o.addBirthday(...e))},"添加生日")],32),e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.birthdays,((t,a)=>(e.openBlock(),e.createElementBlock("li",{key:a},[e.createElementVNode("strong",null,e.toDisplayString(t.name),1),e.createTextVNode(" - "+e.toDisplayString(t.birthday)+" (剩余 "+e.toDisplayString(o.calculateDaysLeft(t.birthday))+" 天) ",1),e.createElementVNode("button",{onClick:e=>o.deleteBirthday(a)},"删除",8,["onClick"])])))),128))])])}],["__scopeId","data-v-db1084db"]]);const l=a({data:()=>({birthday:{name:"",birthday:"",remindDays:0},daysLeft:0,memo:""}),onLoad(e){this.birthday.name=e.name,this.birthday.birthday=e.birthday,this.birthday.remindDays=e.remindDays,this.daysLeft=e.daysLeft,this.loadMemo()},methods:{saveMemo(){const e=uni.getStorageSync("memos")||{};e[this.birthday.name]=this.memo,uni.setStorageSync("memos",e)},loadMemo(){const e=uni.getStorageSync("memos")||{};this.memo=e[this.birthday.name]||""}}},[["render",function(t,a,i,n,r,o){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"}),e.createElementVNode("view",{class:"info-container"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("strong",null,"姓名:"),e.createElementVNode("span",null,e.toDisplayString(r.birthday.name),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("strong",null,"生日:"),e.createElementVNode("span",null,e.toDisplayString(r.birthday.birthday),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("strong",null,"提前提醒天数:"),e.createElementVNode("span",null,e.toDisplayString(r.birthday.remindDays)+" 天",1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("strong",null,"倒计时天数:"),e.createElementVNode("span",null,e.toDisplayString(r.daysLeft)+" 天",1)])]),e.createElementVNode("view",{class:"memo-container"},[e.createElementVNode("strong",null,"备忘录:"),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":a[0]||(a[0]=e=>r.memo=e),class:"memo-textarea",placeholder:"添加备忘录..."},null,512),[[e.vModelText,r.memo]]),e.createElementVNode("button",{onClick:a[1]||(a[1]=(...e)=>o.saveMemo&&o.saveMemo(...e)),class:"save-btn"},"保存备忘录")])])}],["__scopeId","data-v-2be98584"]]);__definePage("pages/addBirthday",i),__definePage("pages/birthdayList",o),__definePage("pages/personalcenter",s),__definePage("pages/index/index",d),__definePage("pages/detail",l);const c={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:h,Vuex:y,Pinia:m}={app:e.createVueApp(c)};uni.Vuex=y,uni.Pinia=m,h.provide("__globalStyles",__uniConfig.styles),h._component.mpType="app",h._component.render=()=>{},h.mount("#app")}(Vue);
